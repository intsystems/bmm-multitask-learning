
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../..">
      
      
        <link rel="next" href="../reference/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.13">
    
    
      
        <title>Introduction - Multitask learning</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#theory-of-variational-multitask-learning-and-its-python-api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Multitask learning" class="md-header__button md-logo" aria-label="Multitask learning" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Multitask learning
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Introduction
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Multitask learning" class="md-nav__button md-logo" aria-label="Multitask learning" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Multitask learning
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Variational
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Variational
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abstract-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Abstract introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-api" class="md-nav__link">
    <span class="md-ellipsis">
      Python API
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elemtary-example" class="md-nav__link">
    <span class="md-ellipsis">
      Elemtary example
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../elementary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Variational multitask learning elementary example
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tusk clustering
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tusk clustering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../task_clustering/multi-task-learning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Neural Network Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../task_clustering/reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sparse multitask
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Sparse multitask
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sbmtl/experiment_testing_method/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Example
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sbmtl/reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Coalescent
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Coalescent
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../coalescent/coalescent_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Example
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../coalescent/reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../coverage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Coverage report
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#abstract-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Abstract introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-api" class="md-nav__link">
    <span class="md-ellipsis">
      Python API
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elemtary-example" class="md-nav__link">
    <span class="md-ellipsis">
      Elemtary example
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="theory-of-variational-multitask-learning-and-its-python-api">Theory of variational multitask learning and its python API</h1>
<h2 id="abstract-introduction">Abstract introduction</h2>
<p>Variational multitask learning is one of the <em>multitask approaches</em> that uses <em>variational inference</em> to define probabilistic connections between tasks and do statistical inference on them (a.k.a. learning). This material is a short adaptation of the <a href="https://proceedings.neurips.cc/paper_files/paper/2021/file/afd4836712c5e77550897e25711e1d96-Paper.pdf">original paper</a><sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>. It is assummed that the reader is familiar with bayessian statistics and variational inderence<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup>. </p>
<p>Imagine you have only one task to predict stochastic output <span class="arithmatex">\(y\)</span> by given input <span class="arithmatex">\(\mathbf{x}\)</span>. Our approach always assumes specific relation between <span class="arithmatex">\(y\)</span> and <span class="arithmatex">\(\mathbf{x}\)</span>. Namely, it will be <em>bayessian</em>: we introduce two hidden random variables. First is <em>classifier</em> <span class="arithmatex">\(\mathbf{w}\)</span> with it's <em>prior</em> distribution <span class="arithmatex">\(p(\mathbf{w})\)</span>. Second is  <em>latent</em> <span class="arithmatex">\(\mathbf{z}\)</span> with its prior <span class="arithmatex">\(p(\mathbf{z} | \mathbf{x})\)</span>. The <span class="arithmatex">\(y\)</span> is then modeled as <span class="arithmatex">\(p(y | \mathbf{z}, \mathbf{w})\)</span>, so there is implicit dependency on input.</p>
<p>The typical situation is that you know your priors up to some parameters. To estimate them from given data <span class="arithmatex">\(\mathcal{D} = \{ \mathcal{X}, \mathcal{Y}\}\)</span> (<span class="arithmatex">\(\mathcal{X} = \{\mathbf{x}_j\}_{j=1}^N\)</span>, <span class="arithmatex">\(\mathcal{Y} = \{y_j\}_{j=1}^N\)</span>) and to build predictions for new inputs we will use <em>variational inference</em>. That means we itroduce <em>variational distribtions</em> <span class="arithmatex">\(q(\mathbf{w} | \mathcal{D})\)</span> and <span class="arithmatex">\(q(\mathbf{z} | \mathcal{D})\)</span> and maximize <em>ELBO</em> objective with respect to var. distributions and priors' parameters. The main method to do it is iterative algorithm called <em>EM-algorithm</em>.</p>
<p>Now imagine you have <span class="arithmatex">\(T\)</span> tasks of the form given above. <em>Variational multitask</em> introduce connection between tasks via classifier and latent priors of each task. Namely, the classifer prior of task <span class="arithmatex">\(i\)</span> is now <span class="arithmatex">\(p(\mathbf{w}_i | \mathcal{D}_{-i})\)</span> and the latent prior for sample <span class="arithmatex">\(j\)</span> is <span class="arithmatex">\(p(\mathbf{z}_{ij} | \mathcal{D}_{-i})\)</span>. Here <span class="arithmatex">\(\mathcal{D}_{-i}\)</span> means samples form all tasks but <span class="arithmatex">\(i\)</span>-th. As one can see this is quite general construction which requires some inital information about priors. To overcome these issues it was proposed to model priors in the following way</p>
<div class="arithmatex">\[
\begin{aligned}
    p(\mathbf{w}_{i}|D_{-i}) &amp;= \sum_{k \not= i}\alpha_{ki}q(\mathbf{w}_{i}|D_{k}), \\
    p(\mathbf{z}_{ij} | \mathbf{x}_{ij},D_{-i}) &amp;= \sum_{k \neq i}\beta_{ki}q(\mathbf{z}_{ij} | \mathbf{x}_{ij}, D_{k}),
\end{aligned}
\]</div>
<p>so that prior for task <span class="arithmatex">\(i\)</span> is a mixture of variational distributions for all other tasks. Mixture coefficients <span class="arithmatex">\(\alpha_{ki}\)</span> and <span class="arithmatex">\(\beta_{ki}\)</span> are generated from <a href="https://en.wikipedia.org/wiki/Gumbel_distribution#Gumbel_reparameterization_tricks"><em>gumbel softmax</em></a>, for example</p>
<div class="arithmatex">\[
    \alpha_{ki} = \frac{\exp((\log \pi_{ki} + g_{ki})/\tau)}{\sum_{s \neq i} \exp((\log \pi_{si} + g_{si})/\tau)},
\]</div>
<p>where <span class="arithmatex">\(\tau\)</span> is a temperature parameter, <a href="https://en.wikipedia.org/wiki/Gumbel_distribution"><span class="arithmatex">\(g_{ki} \sim Gumbel(0, 1)\)</span></a>, <span class="arithmatex">\(\pi_{ki}\)</span> are learnable parameters that represent "connection strength" between task <span class="arithmatex">\(k\)</span> and task <span class="arithmatex">\(i\)</span>. Note, this connection is not symmetrical.</p>
<p>Overall, empirical objective to minimize is sampled ELBO:</p>
<div class="arithmatex">\[
\begin{align*}
\hat{\mathcal{L}}_{\text{VMTL}}(\theta, \phi, \alpha, \beta) 
&amp;= \frac{1}{T} \sum_{t=1}^{T} \Bigg\{ 
   \sum_{n=1}^{N_t} \Bigg\{ 
   \frac{1}{ML} \sum_{\ell=1}^{L} \sum_{m=1}^{M} \Big[ 
   -\log p(\mathbf{y}_t|\mathbf{z}_{t,n}^{(\ell)}, \mathbf{w}_t^{(m)}) 
   \Big] \\
   &amp;\quad + \mathbb{D}_{\text{KL}} \Big[ 
   q_\phi(\mathbf{z}_{t,n}|\mathbf{x}_{t,n}) \,\Big|\Big|\, 
   \sum_{i \neq t} \beta_{ti} q_\phi(\mathbf{z}_{t,n}|\mathbf{x}_{t,n}, \mathcal{D}_i) 
   \Big] \Bigg\} \\
   &amp;\quad + \mathbb{D}_{\text{KL}} \Big[
   q_\theta(\mathbf{w}_t|\mathcal{D}_i) \,\Big|\Big|\,
   \sum_{i \neq t} \alpha_{ti} q_\theta(\mathbf{w}_i|\mathcal{D}_i)
   \Big] \Bigg\}.
\end{align*}
\]</div>
<p>Here we have introduced parameters <span class="arithmatex">\(\theta, \phi\)</span> of the variational distributions; all latents are sampled accordingly <span class="arithmatex">\(\mathbf{z}_{t,n}\sim q_{\phi}(\mathbf{z}_{t,n}|\mathbf{x}_{t,n})\)</span> and <span class="arithmatex">\(\mathbf{w}_{t} \sim q_{\theta}(\mathbf{w}_{t}|\mathcal{D}_{t})\)</span>. The loss structure is intuitively a sum of individual tasks' loss and flexible penalty for tasks disconnection. Due to learnable <span class="arithmatex">\(\alpha, \beta\)</span> each task can connect to the most relevant neighbours.</p>
<p>After learning procedure, one can obtain predictions using learnt variational distributions:</p>
<div class="arithmatex">\[
\begin{align}
    p(\mathbf{y}_t | \mathbf{x}_t) \approx \frac{1}{ML} \sum_{l=1}^L \sum_{m=1}^M p(\mathbf{y}_t | \mathbf{z}_t^{(l)}, \mathbf{w}_t^{(m)}), 
\end{align}\label{eq:pred}
\]</div>
<p>where we draw samples <span class="arithmatex">\(\mathbf{z}_t^{(l)} \sim q_\phi(\mathbf{z}_t|\mathbf{x}_t)\)</span> and 
<span class="arithmatex">\(\mathbf{w}_t^{(m)} \sim q_\theta(\mathbf{w}_t|\mathcal{D}_t)\)</span>. Given results follow from the general variational inference theory.</p>
<h2 id="python-api">Python API</h2>
<p><a href="../reference/"><code>variational</code></a> subpackage of the <a href=""><code>bmm_multitask_learning</code></a> directly follows the theoretical concept of variational multitask learning. Implementaion is based on <em>pytorch</em> framework and its <a href="https://pytorch.org/docs/stable/distributions.html#torch.distributions.distribution.Distribution"><code>distribution</code></a> package.</p>
<p>The <code>elbo</code> module stores <span class="arithmatex">\(\alpha, \beta\)</span> parameters and implements <span class="arithmatex">\(\hat{\mathcal{L}}_{\text{VMTL}}\)</span> objective. User is required to make and pass <code>Callable</code>s with conditional distributions <span class="arithmatex">\(p(y | \mathbf{z}, \mathbf{w})\)</span>, <span class="arithmatex">\(q(\mathbf{z} | x)\)</span> and unconditional <span class="arithmatex">\(q(w)\)</span> as <a href="https://pytorch.org/docs/stable/distributions.html#distribution"><code>Distriution</code></a> objects. User must also provide number of samples for each tasks to properly compute <em>batched</em> objective. User can also control temperature sheduling, number of latent samples used in empirical objective, and number of samples used in KL estimation (used if there is no explicit formula for given distributions).</p>
<p>The <code>distr</code> module implements prediction distribution (1) and <span class="arithmatex">\(\mathbb{D}_{\text{KL}}(\cdot, \cdot)\)</span> estimation via sampling. </p>
<h2 id="elemtary-example">Elemtary example</h2>
<p>Go to the simple <a href="../elementary/">demostration</a> of how <code>variational</code> subpackage can be used.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>Shen, Jiayi, et al. "Variational multi-task learning with gumbel-softmax priors." Advances in Neural Information Processing Systems 34 (2021): 21031-21042.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>Bishop, Christopher M. Pattern Recognition and Machine Learning. New York :Springer, 2006.&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>